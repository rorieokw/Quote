@inject Quote.Mobile.Services.AuthService AuthService
@inject NavigationManager Navigation

<div class="top-row navbar navbar-light">
    <div class="container-fluid">
        <a class="navbar-brand" href="">
            <span class="brand-icon">Q</span>
            <span class="brand-text">Quote</span>
        </a>
        <button class="navbar-toggler" @onclick="ToggleMenu">
            <span class="toggler-icon"></span>
        </button>
    </div>
</div>

<div class="nav-overlay @(isMenuOpen ? "show" : "")" @onclick="CloseMenu"></div>

<div class="nav-scrollable @(isMenuOpen ? "show" : "")">
    <nav class="flex-column">
        <div class="nav-item">
            <NavLink class="nav-link" href="" Match="NavLinkMatch.All" @onclick="CloseMenu">
                <span class="nav-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        <polyline points="9 22 9 12 15 12 15 22"></polyline>
                    </svg>
                </span>
                Home
            </NavLink>
        </div>
        <div class="nav-item">
            <NavLink class="nav-link" href="jobs" @onclick="CloseMenu">
                <span class="nav-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
                        <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
                    </svg>
                </span>
                Browse Jobs
            </NavLink>
        </div>
        <div class="nav-item">
            <NavLink class="nav-link" href="my-quotes" @onclick="CloseMenu">
                <span class="nav-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                    </svg>
                </span>
                My Quotes
            </NavLink>
        </div>
        <div class="nav-item">
            <NavLink class="nav-link" href="tradie/map" @onclick="CloseMenu">
                <span class="nav-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"></polygon>
                        <line x1="8" y1="2" x2="8" y2="18"></line>
                        <line x1="16" y1="6" x2="16" y2="22"></line>
                    </svg>
                </span>
                Job Map
            </NavLink>
        </div>
        <div class="nav-item">
            <NavLink class="nav-link" href="profile" @onclick="CloseMenu">
                <span class="nav-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                </span>
                Profile
            </NavLink>
        </div>

        <div class="nav-divider"></div>

        <div class="nav-item">
            <button class="nav-link logout-btn" @onclick="Logout">
                <span class="nav-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                        <polyline points="16 17 21 12 16 7"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                </span>
                Sign Out
            </button>
        </div>
    </nav>
</div>

@code {
    private bool isMenuOpen = false;

    private void ToggleMenu()
    {
        isMenuOpen = !isMenuOpen;
    }

    private void CloseMenu()
    {
        isMenuOpen = false;
    }

    private async Task Logout()
    {
        await AuthService.LogoutAsync();
        Navigation.NavigateTo("/login", true);
    }
}
